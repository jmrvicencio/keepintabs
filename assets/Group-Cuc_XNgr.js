import{u as g,r as i,d as v,a as y,R as b,z as C,j as e,c as M,L as P}from"./index--mqDWwSn.js";import{q as D,H as O}from"./firebase-D57XAA0E.js";import{a as $,P as S}from"./debuggerFunctions-B0xoZgD2.js";import{c as N}from"./createLucideIcon-BtrpMuvF.js";import"./react-gH-7aFTg.js";import"./useDebug-BtOGFeYd.js";import"./v4-BKrj-4V8.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],A=N("arrow-left",U);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],z=N("menu",G),T=(t="")=>{const s=g(),[n,l]=i.useState(null),[o,a]=i.useState(null),[c,u]=i.useState(!1);let d;return i.useEffect(()=>((async()=>{const x=D(v,"groups",t);if(!c)try{console.log("subscribing to snapshot"),d=O(x,r=>{l(r);const h=r.data(),p=Object.entries(h.members);for(const[w,k]of p){const j=k;if(j.linkedUid==y.currentUser?.uid){j.groupUid=w,a(j);break}}},r=>{d(),console.error(r),s(b.APP)})}catch(r){const h=r;throw C.error(h.message),r}})(),()=>{console.log("ubsubscribing to snapshot"),u(!0)}),[]),{group:n,userData:o}};function Y(t,s,n){return Math.min(Math.max(t,s),n)}function L(t){if(!t||!t.balance)return{};const s={},n={};for(let[l,o]of Object.entries(t.balance))for(let[a,c]of Object.entries(o))s[a]=(s[a]??0)-c,s[l]=(s[l]??0)+c;for(let l of Object.keys(s)){n[l]=n[l]??{};for(let o of Object.keys(s))if(n[o]=n[o]??{},l!=o&&s[l]<0&&s[o]>0){const a=Y(-s[l],0,s[o]);n[l][o]=-a,n[o][l]=a,s[l]+=a,s[o]-=a}}return n}function R(t,s){return!t||!s||!s[t]?0:Object.values(s[t]).reduce((n,l)=>n+l,0)}const E=({onClick:t=()=>{},setShowSelf:s=()=>{},children:n})=>{const l=()=>{s(!1),t()};return e.jsx("div",{onClick:l,className:"absolute inset-0 z-10",children:n})},f=({children:t,onClick:s=()=>{},bgColor:n,padding:l,rounded:o,wallColor:a,dropOnClick:c=!1,className:u=""})=>{const[d,m]=i.useState(!1),x=h=>{c&&(h.stopPropagation(),m(!0))},r=()=>{m(!1)};return e.jsxs("div",{className:"relative pr-1 pb-1",onMouseDown:x,onPointerDown:x,onMouseUp:r,onPointerUp:r,onMouseLeave:r,onTouchMove:r,children:[e.jsx("div",{className:`${d&&"pressed"} ${n||"bg-white"} ${l||"p-2"} ${u} ${o||"rounded-2xl"} border-ink-800 relative z-1 border-1 transition-transform [.pressed]:translate-0.5`,children:t}),e.jsx("div",{className:`${o||"rounded-2xl"} ${a||"bg-ink-800"} border-ink-800 absolute inset-x-0.5 inset-y-0.5 right-0 bottom-0 z-0 border-1`})]})},_=({children:t,onClick:s=()=>{},bgColor:n,padding:l,rounded:o,wallColor:a,dropOnClick:c=!1,className:u=""})=>{const[d,m]=i.useState(!1),x=h=>{c&&(h.stopPropagation(),m(!0))},r=()=>{m(!1)};return e.jsxs("div",{className:"relative pb-1",onMouseDown:x,onPointerDown:x,onMouseUp:r,onPointerUp:r,onMouseLeave:r,onTouchMove:r,children:[e.jsx("div",{className:`${d&&"pressed"} ${n||"bg-white"} ${l||"p-2"} ${u} ${o||"rounded-2xl"} border-ink-800 relative z-1 border-1 transition-transform [.pressed]:translate-y-0.5`,children:t}),e.jsx("div",{className:`${o||"rounded-2xl"} ${a||"bg-ink-800"} border-ink-800 absolute inset-x-0 inset-y-0.5 bottom-0 z-0 border-1`})]})},Z=i.memo(function(){const s=g();$();const n=i.memo(()=>e.jsx(S,{})),{group:l}=M(),{group:o,userData:a}=T(l),c=o?.data(),[u,d]=i.useState(!1),m=i.useRef(null),x=m.current?.getBoundingClientRect(),r=L(o?.data()),h={total:R(a?.groupUid,r),records:r},p=i.useCallback(async()=>{console.log("param: ",l),s(`${b.NEW_TRANSACTION}${l&&"?g="+l}`)},[]);return e.jsxs(e.Fragment,{children:[u&&e.jsx(E,{setShowSelf:d,children:e.jsx("div",{className:"absolute h-10 w-10 border-1 border-red-500 bg-amber-800",style:{top:x?.bottom,right:window.innerWidth-(x?.right??0)}})}),e.jsxs("div",{className:"relative flex shrink-0 grow-1 flex-col pt-3",children:[e.jsxs("main",{className:"flex h-full flex-col items-stretch",children:[e.jsx(B,{userBalance:h,groupData:c,userGroupUid:a?.groupUid,ref:m,setShowGroupMenu:d}),e.jsxs("section",{className:"font-outfit flex h-full flex-col rounded-t-3xl px-3",children:[e.jsxs("div",{className:"text-leather-900 my-6 flex w-full flex-row items-baseline justify-between px-3",children:[e.jsxs("h2",{className:"text-2xl",children:["August ",e.jsx("span",{className:"font-bold",children:"2024"})]}),e.jsx("p",{children:"2 Transactions"})]}),e.jsxs("div",{className:"flex flex-col gap-2 pb-24",children:[e.jsxs(f,{className:"justfiy-center flex flex-row gap-3",dropOnClick:!0,children:[e.jsxs("div",{className:"bg-accent-200 text-ink-800 flex w-10 flex-col justify-center gap-0 rounded-lg",children:[e.jsx("p",{className:"text-base/4",children:"Aug"}),e.jsx("p",{className:"text-2xl font-bold",children:"25"})]}),e.jsxs("div",{className:"text-charcoal-800 grow-1 text-left",children:[e.jsx("h3",{className:"text-leater text-lg/snug font-medium",children:"Mendokoro"}),e.jsx("p",{className:"font-light",children:"You paid Php 2,000"}),e.jsx("div",{children:e.jsx("p",{className:"border-shell-300 w-fit rounded-lg border-1 px-1 text-sm/tight font-light",children:"Gcash"})})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("p",{className:"text-charcoal-600 font-medium",children:"Php 2,000"}),e.jsxs("p",{className:"mb-2 flex flex-row items-center justify-end gap-1 text-sm font-light",children:["You lent",e.jsx("span",{className:"bg-positive-500 h-2 w-2 rounded-full"})]}),e.jsx(f,{padding:"py-0 px-4",bgColor:"bg-accent-200",rounded:"rounded-lg",dropOnClick:!0,children:e.jsx("p",{className:"text-sm font-normal",children:"Details"})})]})]}),e.jsxs(f,{className:"justfiy-center flex flex-row gap-3",dropOnClick:!0,children:[e.jsxs("div",{className:"bg-accent-200 text-ink-800 flex w-10 flex-col justify-center gap-0 rounded-lg",children:[e.jsx("p",{className:"text-base/4",children:"Aug"}),e.jsx("p",{className:"text-2xl font-bold",children:"25"})]}),e.jsxs("div",{className:"text-charcoal-800 grow-1 text-left",children:[e.jsx("h3",{className:"text-leater text-lg/snug font-medium",children:"Mendokoro"}),e.jsx("p",{className:"font-light",children:"You paid Php 2,000"}),e.jsx("div",{children:e.jsx("p",{className:"border-shell-300 w-fit rounded-lg border-1 px-1 text-sm/tight font-light",children:"Gcash"})})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("p",{className:"text-charcoal-600 font-medium",children:"Php 2,000"}),e.jsxs("p",{className:"mb-2 flex flex-row items-center justify-end gap-1 text-sm font-light",children:["You lent",e.jsx("span",{className:"bg-positive-500 h-2 w-2 rounded-full"})]}),e.jsx(f,{padding:"py-0 px-4",bgColor:"bg-accent-200",rounded:"rounded-lg",dropOnClick:!0,children:e.jsx("p",{className:"text-sm font-normal",children:"Details"})})]})]}),e.jsxs(f,{className:"justfiy-center flex flex-row gap-3",dropOnClick:!0,children:[e.jsxs("div",{className:"bg-accent-200 text-ink-800 flex w-10 flex-col justify-center gap-0 rounded-lg",children:[e.jsx("p",{className:"text-base/4",children:"Aug"}),e.jsx("p",{className:"text-2xl font-bold",children:"25"})]}),e.jsxs("div",{className:"text-charcoal-800 grow-1 text-left",children:[e.jsx("h3",{className:"text-leater text-lg/snug font-medium",children:"Mendokoro"}),e.jsx("p",{className:"font-light",children:"You paid Php 2,000"}),e.jsx("div",{children:e.jsx("p",{className:"border-shell-300 w-fit rounded-lg border-1 px-1 text-sm/tight font-light",children:"Gcash"})})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("p",{className:"text-charcoal-600 font-medium",children:"Php 2,000"}),e.jsxs("p",{className:"mb-2 flex flex-row items-center justify-end gap-1 text-sm font-light",children:["You lent",e.jsx("span",{className:"bg-positive-500 h-2 w-2 rounded-full"})]}),e.jsx(f,{padding:"py-0 px-4",bgColor:"bg-accent-200",rounded:"rounded-lg",dropOnClick:!0,children:e.jsx("p",{className:"text-sm font-normal",children:"Details"})})]})]})]})]})]}),e.jsxs(H,{onClick:p,children:[e.jsx(n,{}),"Add Transaction"]})]})]})}),B=({userBalance:t,groupData:s,userGroupUid:n,setShowGroupMenu:l,ref:o})=>{const a=i.memo(()=>e.jsx(z,{onClick:()=>l(!0),className:"w-8 cursor-pointer"}));return e.jsxs("section",{className:"border-wheat-400 mx-3 flex grow-1 flex-col items-start gap-3 border-b-1 border-dashed pb-8",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(P,{to:b.APP,children:e.jsx("div",{className:"text-ink-800 pointer-cursor mb-4 flex flex-row items-center gap-2 text-lg font-normal",children:e.jsx(f,{bgColor:"bg-accent-200",dropOnClick:!0,children:e.jsx(A,{className:"text-ink-800"})})})}),e.jsxs("div",{className:"mb-3 flex w-full flex-row items-center justify-between",ref:o,children:[e.jsx("h1",{className:"font-gieonto text-left text-4xl font-medium",children:s?.name}),e.jsx(a,{})]}),e.jsx(F,{total:t.total})]}),t?.total!=0&&t?.total!=null&&e.jsx(f,{padding:"px-4 py-2",children:Object.entries(t.records[n??""]).map(([c,u])=>{const d=s?.members[c].displayName??"unkown";return e.jsx(I,{name:d,amt:u},c)})}),e.jsx("p",{className:"text-xs opacity-72",children:"Debts are being simplified"}),e.jsx("div",{className:"border-charcoal-300 cursor-pointer rounded-xl border-1 px-3 py-1",children:"See full breakdown"})]})},F=({total:t})=>e.jsx("h2",{className:"font-outfit w-fit text-xl font-light",children:t?e.jsxs(e.Fragment,{children:[t>0?"You are owed":"You owe",e.jsxs("span",{className:"font-bold",children:[" Php ",Math.abs(t)]})]}):"debts clear"}),I=({name:t,amt:s})=>s<0?e.jsxs("p",{className:"text-left",children:["You owe ",t," ",e.jsxs("span",{className:"font-outfit text-negative-500 font-bold",children:["Php ",Math.abs(s)]})]}):e.jsxs("p",{className:"text-left",children:[t," owes you ",e.jsxs("span",{className:"font-outfit text-positive-500 font-bold",children:["Php ",Math.abs(s)]})]}),H=i.memo(({onClick:t,children:s})=>e.jsx("div",{className:"fixed bottom-6 left-1/2 z-5 w-fit -translate-x-1/2",children:e.jsx(_,{className:"flex flex-row text-white",bgColor:"bg-accent-600",dropOnClick:!0,children:s})}));export{Z as default};
