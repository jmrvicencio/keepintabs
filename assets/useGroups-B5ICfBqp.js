import{r as a,d as p,b as w,z as g}from"./index-D63cc4uB.js";import{D,B as S,H as A,I as y,J as E,K as F}from"./firebase-wjis4Syq.js";import{d as b}from"./dataFetched-C1XQfnbQ.js";import{u as v}from"./useDebug-BhBm4-hj.js";const z=(n=b)=>{const[d,f]=a.useState([]),[u,i]=a.useState(!0),[l,h]=a.useState(!1),[s,o]=v(n);a.useEffect(()=>{const e=()=>{Date.now()-s.fetchedAt>s.staleTime&&r()};return window.addEventListener("focus",e),()=>{window.removeEventListener("focus",e)}},[s]),a.useEffect(()=>{r()},[l]);async function r(){try{let e;const t=Date.now()-s.fetchedAt>s.staleTime,c=D(S(p,"groups"),A("memberUids","array-contains",w.currentUser.uid),y("createdAt"));s.fetched&&!t?e=await E(c):(e=await F(c),o({...s,fetched:!0,fetchedAt:Date.now()}),console.log("setting data fetched!")),i(()=>!1),f(e.docs)}catch(e){const t=e;throw g.error(t.message),e}}const m=a.useCallback((e=!1)=>{e&&o(t=>({...t,fetched:!1})),h(t=>!t)},[]);return{groups:d,loading:u,reload:m}};export{z as u};
