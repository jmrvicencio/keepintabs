import{r as o,d as j,a as w,z as b,j as e,u as p,g as N,R as v}from"./index--mqDWwSn.js";import{x as D,y,z as G,A,B as E,D as S}from"./firebase-D57XAA0E.js";import{a as F,u as O,b as P}from"./useDebug-BtOGFeYd.js";import{u as C,P as T}from"./debuggerFunctions-B0xoZgD2.js";import{S as k}from"./SmallButton-CSEgtKcI.js";import"./react-gH-7aFTg.js";import"./createLucideIcon-BtrpMuvF.js";import"./v4-BKrj-4V8.js";const R={fetched:!1,fetchedAt:0,staleTime:300*1e3},U=F(R),z=(x=U)=>{const[c,l]=o.useState([]),[n,d]=o.useState(!0),[f,m]=o.useState(!1),[r,u]=O(x);o.useEffect(()=>{const t=()=>{Date.now()-r.fetchedAt>r.staleTime&&s()};return window.addEventListener("focus",t),()=>{console.log("remove listener"),window.removeEventListener("focus",t)}},[r]),o.useEffect(()=>{s()},[f]);async function s(){try{const t=D(y(j,"groups"),G("memberUids","array-contains",w.currentUser.uid),A("createdAt"));let a;const g=Date.now()-r.fetchedAt>r.staleTime;r.fetched&&!g?a=await E(t):(a=await S(t),u({...r,fetched:!0,fetchedAt:Date.now()}),console.log("setting data fetched!")),d(()=>!1),l(a.docs)}catch(t){const a=t;throw b.error(a.message),t}}const i=o.useCallback((t=!1)=>{t&&u(a=>({...a,fetched:!1})),m(a=>!a)},[]);return{groups:c,loading:n,reload:i}};function h(){return e.jsx("div",{className:"bg-charcoal-700 border-charcoal-800 h-5 w-5 rounded-full border-1 not-first:-ml-1"})}const B=o.memo(function({id:c,group:l}){const n=p(),d=()=>{n(N(c))};return e.jsxs("div",{className:"bg-charcoal-800 flex w-full cursor-pointer flex-col gap-2 rounded-xl p-1",onClick:d,children:[e.jsxs("div",{className:"text-sand flex flex-row items-center justify-between px-2",children:[e.jsx("p",{className:"font-medium",children:l.name}),e.jsxs("div",{className:"border-charcoal-600 flex flex-row items-center rounded-full border-1 p-1 pl-2",children:[e.jsx("p",{className:"font-noto-sans mr-2 align-top text-base/4",children:"1"}),e.jsx(h,{}),e.jsx(h,{}),e.jsx(h,{})]})]}),e.jsxs("div",{className:"bg-charcoal-700 flex w-full flex-row justify-between gap-2 rounded-lg p-2",children:[e.jsx("div",{className:"bg-accent-200 w-2 rounded-xs"}),e.jsx("p",{className:"grow-1 text-left",children:"You Owe"}),e.jsx("p",{className:"font-noto-sans text-accent-200",children:"PHP 4,260.00"})]})]})}),K=o.memo(function(){const c=p(),{groups:l,loading:n,reload:d}=z(),{addOption:f,removeOption:m}=P();C(d),o.useEffect(()=>{const s={text:"Test Dashboard",action:()=>{console.log("this is a test")}};return f(s.text,s.action),()=>{m(s.text)}},[]);const r=o.memo(({className:s="w-4"})=>e.jsx(T,{className:s})),u=async()=>{c(v.NEW_GROUP)};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"relative flex w-dvw shrink-0 flex-col gap-8 p-3",children:e.jsxs("main",{className:"flex flex-col items-start gap-8",children:[e.jsxs("section",{className:"flex flex-col items-start gap-3",children:[e.jsx("h1",{className:"font-noto-sans text-sand text-left text-4xl font-medium",children:"Debts Clear!"}),e.jsx("p",{className:"text-xl font-light",children:"No outstanding balance"})]}),e.jsxs("section",{className:"w-full",children:[e.jsxs("div",{className:"mb-4 flex flex-row gap-2",children:[e.jsx("p",{className:"font-normal",children:"Groups"}),e.jsx(k,{onClick:u,children:e.jsx(r,{})})]}),e.jsx("div",{className:"flex flex-col gap-2",children:n?[...Array(5)].map((s,i)=>e.jsx("div",{className:"bg-charcoal-500 h-22 w-full animate-pulse cursor-pointer rounded-xl"},i)):e.jsxs(e.Fragment,{children:[l?.map(s=>{const i=s.data();return e.jsx(B,{id:s.id,group:i},s.id)}),e.jsxs("div",{className:"border-charcoal-700 flex w-full cursor-pointer flex-col gap-2 rounded-xl border-1 p-1",children:[e.jsx("div",{className:"text-sand flex flex-row items-center justify-between px-2",children:e.jsx("p",{className:"font-medium",children:"Non Grouped Expenses"})}),e.jsxs("div",{className:"bg-charcoal-500 flex w-full flex-row justify-between gap-2 rounded-lg p-2",children:[e.jsx("div",{className:"bg-accent-200 w-2 rounded-xs"}),e.jsx("p",{className:"grow-1 text-left",children:"You Owe"}),e.jsx("p",{className:"font-noto-sans text-accent-200",children:"PHP 4,260.00"})]})]})]})})]})]})})})});export{K as default};
